# Trampoline Prefactor

Note: opening a new doc for the open PR, lots of notes are in
ldk-trampoline.md.

## Review Round 1 (Matt)

Easy fixes:
- [ ] Need to write values in `PaymentForwarded` w/ one HTLC
- [ ] Can we use `init_and_real_tlv_fields` for `HTLCSource`?

Bigger questions:
- Q: why are we happy to just have the path of hops in `Source`

In the next PR we'll add dispatch of trampoline payments and store them in `pending_outbound_payments`.
We'll store the `TrampolineOnionPacket` and `BlindingPoint` in our `PendingOutboundPayment`, so we don't need to duplicate them in each outgoing HTLC's `HTLCSource`.

Q: What about the blinded tail we're paying to? For blinded errors?
- [bug] Looks like the `BlindedTail` is missing in follow up PR!
  `fail_htlc_backwards_internal` just sets this to `None`?
  which is used in `trampoline_htlc_failed` (incorrectly, since it'll
  always be `None`!)

- [missing] On startup we need to do reconcilliation of forwards:
  This is just completely missing from the original PR series, needs
  to be added.
  
