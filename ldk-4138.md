# Break up and function-ize `handle_new_monitor_update`

## Review Round 1

### Extract monitor update res handling to fn

- Getting rid of the overload with 6 args (incl tag):
  - $self: ident
  - $update_res: expr
  - $logger: expr
  - $channel_id: expr
  - _internal
  - $completed: expr
- This is used internally in the macro when:
  - We call it with `INITIAL_MONITOR`
    - Happens in `internal_funding_signed`
  - We call it with `_internal_outer`
    - This happens in a few invocations:
      - `REMAIN_LOCKED_UPDATE_ACTIONS_PROCESSED_LATER`
      - `POST_CHANNEL_CLOSE`

Comparing new function to macro expansion:
- Asserts that we have the correct `Ordering::Acquire`
- Matches on the `update_res` provided
  - `UnrecoverableError`:
    - Log and panic
  - `InProgress`:
    - If not in tests, assert that swapping our ordering gives us 2
    - Log
    - Return false
  - `Completed`:
    - If not in tests, assert that swapping our ordering gives us 1
    - Return true

Switch out for function is 1:1! Nice.

Check callsites still have the same success cases:
- `handle_new_monitor_update_completion`
- `$completed`

### Extract macro for initial monitor persist

- Pull the `INITIAL_MONITOR` tag out exactly into its own macro

### Extract post-close monitor update macro

- Pulls the `POST_CHANNEL_CLOSE` case out into its own macro

### Extract macro for new monitor upd, process actions later

- Exactly pulls out the previous overload

### Extract _internal macro for new mon update handling

- Pulls out the `inner_outer` tag
